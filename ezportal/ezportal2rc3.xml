<?xml version="1.0"?>
<!DOCTYPE modification SYSTEM "http://www.simplemachines.org/xml/modification">
<modification xmlns="http://www.simplemachines.org/xml/modification" xmlns:smf="http://www.simplemachines.org/">
<id>vbgamer45:ezportal</id>
<version>0.2</version>
<file name="$languagedir/Modifications.english.php">
	<operation>
		<search position="end" />
		<add><![CDATA[
// Begin EzPortal Text Strings
$txt['ezp_forum_tab'] = 'Forum';
$txt['ezportal_admin'] = 'EzPortal';
$txt['ezportal_settings'] = 'Settings';
$txt['ezportal_block_manager'] = 'ezBlock Manager';
$txt['ezportal_page_manager'] = 'Page Manager';

$txt['ezp_settings'] = 'Settings';
$txt['ezp_modules'] = 'Modules';
$txt['ezp_blocks'] = 'ezBlocks';
$txt['ezp_pagemanager'] = 'Page Manager';
$txt['ezp_import'] = 'Import';
$txt['ezp_txt_ordercopyright'] = 'Order Copyright Removal';
$txt['ezp_download_blocks'] = 'Download ezBlocks';
$txt['ezp_installed_blocks'] = 'Installed ezBlocks';
$txt['ezp_txt_copyrightremoval'] = 'Copyright Removal';
$txt['ezp_credits'] = 'Credits';

// Permissions
$txt['permissiongroup_ezportal'] = 'EzPortal';
$txt['permissiongroup_simple_ezportal'] = 'Use EzPortal';

$txt['permissionname_ezportal_page'] = 'Manage Pages';
$txt['permissionhelp_ezportal_page'] = 'Allows adding,editing,and deleting of pages.';
$txt['cannot_ezportal_page'] = 'You are not allowed to manage EzPortal pages.';

$txt['permissionname_ezportal_blocks'] = 'Manage ezBlocks';
$txt['permissionhelp_ezportal_blocks'] = 'Allows adding,editing,and deleting of ezBlocks.';
$txt['cannot_ezportal_blocks'] = 'You are not allowed to manage ezBlocks.';


$txt['permissionname_ezportal_manage'] = 'Admin EzPortal';
$txt['permissionhelp_ezportal_manage'] = 'Allows full control of EzPortal';
$txt['cannot_ezportal_manage'] = 'You are not allowed to manage EzPortal.';



// END EzPortal Text Strings			
]]></add>
	</operation>
</file>

<file name="$languagedir/Modifications.english-utf8.php" error="skip">
	<operation>
		<search position="end" />
		<add><![CDATA[
// Begin EzPortal Text Strings
$txt['ezp_forum_tab'] = 'Forum';
$txt['ezportal_admin'] = 'EzPortal';
$txt['ezportal_settings'] = 'Settings';
$txt['ezportal_block_manager'] = 'ezBlock Manager';
$txt['ezportal_page_manager'] = 'Page Manager';

$txt['ezp_settings'] = 'Settings';
$txt['ezp_modules'] = 'Modules';
$txt['ezp_blocks'] = 'ezBlocks';
$txt['ezp_pagemanager'] = 'Page Manager';
$txt['ezp_import'] = 'Import';
$txt['ezp_txt_ordercopyright'] = 'Order Copyright Removal';
$txt['ezp_download_blocks'] = 'Download ezBlocks';
$txt['ezp_installed_blocks'] = 'Installed ezBlocks';
$txt['ezp_txt_copyrightremoval'] = 'Copyright Removal';
$txt['ezp_credits'] = 'Credits';

// Permissions
$txt['permissiongroup_ezportal'] = 'EzPortal';
$txt['permissiongroup_simple_ezportal'] = 'Use EzPortal';

$txt['permissionname_ezportal_page'] = 'Manage Pages';
$txt['permissionhelp_ezportal_page'] = 'Allows adding,editing,and deleting of pages.';
$txt['cannot_ezportal_page'] = 'You are not allowed to manage EzPortal pages.';

$txt['permissionname_ezportal_blocks'] = 'Manage ezBlocks';
$txt['permissionhelp_ezportal_blocks'] = 'Allows adding,editing,and deleting of ezBlocks.';
$txt['cannot_ezportal_blocks'] = 'You are not allowed to manage ezBlocks.';


$txt['permissionname_ezportal_manage'] = 'Admin EzPortal';
$txt['permissionhelp_ezportal_manage'] = 'Allows full control of EzPortal';
$txt['cannot_ezportal_manage'] = 'You are not allowed to manage EzPortal.';

// END EzPortal Text Strings			
]]></add>
	</operation>
</file>


<file name="$languagedir/Modifications.turkish.php" error="skip">
	<operation>
		<search position="end" />
		<add><![CDATA[
// Begin EzPortal Text Strings
$txt['ezp_forum_tab'] = 'Forum';
$txt['ezportal_admin'] = 'EzPortal';
$txt['ezportal_settings'] = 'Ayarlar';
$txt['ezportal_block_manager'] = 'ezBlock Yöneticisi';
$txt['ezportal_page_manager'] = 'Sayfa Yöneticisi';

$txt['ezp_settings'] = 'Ayarlar';
$txt['ezp_modules'] = 'Modüller';
$txt['ezp_blocks'] = 'ezBlocklar';
$txt['ezp_pagemanager'] = 'Sayfa Yöneticisi';
$txt['ezp_import'] = 'İçe Aktar';
$txt['ezp_txt_ordercopyright'] = 'Telif Hakkı Kaldırma Siparişi';
$txt['ezp_download_blocks'] = 'ezBlockları İndir';
$txt['ezp_installed_blocks'] = 'Yüklü ezBlocklar';
$txt['ezp_txt_copyrightremoval'] = 'Telif Hakkı Kaldırma';
$txt['ezp_credits'] = 'Krediler';

// Permissions
$txt['permissiongroup_ezportal'] = 'EzPortal';
$txt['permissiongroup_simple_ezportal'] = 'EzPortal Kullan';

$txt['permissionname_ezportal_page'] = 'Sayfaları Yönet';
$txt['permissionhelp_ezportal_page'] = 'Sayfa ekleme, düzenleme ve silme yeteneğini sağlar.';
$txt['cannot_ezportal_page'] = 'EzPortal sayfalarını yönetme izniniz yok.';

$txt['permissionname_ezportal_blocks'] = 'ezBlockları Yönet';
$txt['permissionhelp_ezportal_blocks'] = 'ezBlock ekleme, düzenleme ve silme yeteneğini sağlar.';
$txt['cannot_ezportal_blocks'] = 'ezBlockları yönetme izniniz yok.';

$txt['permissionname_ezportal_manage'] = 'EzPortal Yönet';
$txt['permissionhelp_ezportal_manage'] = 'EzPortal üzerinde tam kontrol sağlar';
$txt['cannot_ezportal_manage'] = 'EzPortal yönetme izniniz yok.';

$txt['whoall_forum'] = '<a href="' . $scripturl . '">' . $context['forum_name'] . '</a>\'daki indeksi görüntülüyor.';


// END EzPortal Text Strings
]]></add>
	</operation>
</file>


<file name="$languagedir/Modifications.portuguese_pt.php" error="skip">
	<operation>
		<search position="end" />
		<add><![CDATA[
// Begin EzPortal Text Strings
$txt['ezp_forum_tab'] = 'Fórum';
$txt['ezportal_admin'] = 'EzPortal';
$txt['ezportal_settings'] = 'Configurações';
$txt['ezportal_block_manager'] = 'Gerenciador ezBlock';
$txt['ezportal_page_manager'] = 'Gerenciador de páginas';

$txt['ezp_settings'] = 'Configurações';
$txt['ezp_modules'] = 'Módulos';
$txt['ezp_blocks'] = 'ezBlocks';
$txt['ezp_pagemanager'] = 'Gerenciador de páginas';
$txt['ezp_import'] = 'Importar';
$txt['ezp_txt_ordercopyright'] = 'Solicitar remoção de copyright';
$txt['ezp_download_blocks'] = 'Download ezBlocks';
$txt['ezp_installed_blocks'] = 'ezBlocks instalados';
$txt['ezp_txt_copyrightremoval'] = 'Remoção de Copyright';
$txt['ezp_credits'] = 'Créditos';

// Permissões
$txt['permissiongroup_ezportal'] = 'EzPortal';
$txt['permissiongroup_simple_ezportal'] = 'Use o EzPortal';

$txt['permissionname_ezportal_page'] = 'Gerenciar páginas';
$txt['permissionhelp_ezportal_page'] = 'Permite adição, edição e remoção de páginas.';
$txt['cannot_ezportal_page'] = 'Você não tem permissão para gerenciar páginas do EzPortal.';

$txt['permissionname_ezportal_blocks'] = 'Gerenciar ezBlocks';
$txt['permissionhelp_ezportal_blocks'] = 'Permite adição, edição e remoção de ezBlocks.';
$txt['cannot_ezportal_blocks'] = 'Você não tem permissão para gerenciar ezBlocks.';


$txt['permissionname_ezportal_manage'] = 'Administrar EzPortal';
$txt['permissionhelp_ezportal_manage'] = 'Permite controle total do EzPortal';
$txt['cannot_ezportal_manage'] = 'Você não tem permissão para gerenciar EzPortal.';


$txt['whoall_forum'] = 'Visualizando o índice de <a href="' . $scripturl . '">' . $context['forum_name'] . '</a>.';

// END EzPortal Text Strings
]]></add>
	</operation>
</file>

<file name="$languagedir/Modifications.spanish_es.php" error="skip">
	<operation>
		<search position="end" />
		<add><![CDATA[
// Begin EzPortal Text Strings
$txt['ezp_forum_tab'] = 'Foro';
$txt['ezportal_admin'] = 'EzPortal';
$txt['ezportal_settings'] = 'Configuraciones';
$txt['ezportal_block_manager'] = 'Administrador de ezBlock';
$txt['ezportal_page_manager'] = 'Administrador de Páginas';

$txt['ezp_settings'] = 'Configuraciones';
$txt['ezp_modules'] = 'Módulos';
$txt['ezp_blocks'] = 'ezBlocks';
$txt['ezp_pagemanager'] = 'Administrador de Páginas';
$txt['ezp_import'] = 'Importar';
$txt['ezp_txt_ordercopyright'] = 'Ordenar la Eliminación de Derechos de Autor';
$txt['ezp_download_blocks'] = 'Descargar ezBlocks';
$txt['ezp_installed_blocks'] = 'ezBlocks Instalados';
$txt['ezp_txt_copyrightremoval'] = 'Eliminación de Derechos de Autor';
$txt['ezp_credits'] = 'Créditos';

// Permisos
$txt['permissiongroup_ezportal'] = 'EzPortal';
$txt['permissiongroup_simple_ezportal'] = 'Usar EzPortal';

$txt['permissionname_ezportal_page'] = 'Administrar Páginas';
$txt['permissionhelp_ezportal_page'] = 'Permite añadir, editar y eliminar páginas.';
$txt['cannot_ezportal_page'] = 'No tienes permiso para administrar páginas de EzPortal.';

$txt['permissionname_ezportal_blocks'] = 'Administrar ezBlocks';
$txt['permissionhelp_ezportal_blocks'] = 'Permite añadir, editar y eliminar ezBlocks.';
$txt['cannot_ezportal_blocks'] = 'No tienes permiso para administrar ezBlocks.';


$txt['permissionname_ezportal_manage'] = 'Administrar EzPortal';
$txt['permissionhelp_ezportal_manage'] = 'Permite el control total de EzPortal';
$txt['cannot_ezportal_manage'] = 'No tienes permiso para administrar EzPortal.';


$txt['whoall_forum'] = 'Viendo el índice de <a href="' . $scripturl . '">' . $context['forum_name'] . '</a>.';

// END EzPortal Text Strings
]]></add>
	</operation>
</file>



<file name="$languagedir/Modifications.german.php" error="skip">
	<operation>
		<search position="end" />
		<add><![CDATA[
// Begin EzPortal Text Strings
$txt['ezp_forum_tab'] = 'Forum';
$txt['ezportal_admin'] = 'EzPortal';
$txt['ezportal_settings'] = 'Einstellungen';
$txt['ezportal_block_manager'] = 'ezBlock Manager';
$txt['ezportal_page_manager'] = 'Seitenmanager';

$txt['ezp_settings'] = 'Einstellungen';
$txt['ezp_modules'] = 'Module';
$txt['ezp_blocks'] = 'ezBlöcke';
$txt['ezp_pagemanager'] = 'Seitenmanager';
$txt['ezp_import'] = 'Import';
$txt['ezp_txt_ordercopyright'] = 'Urheberrecht Entfernung bestellen';
$txt['ezp_download_blocks'] = 'Download ezBlöcke';
$txt['ezp_installed_blocks'] = 'Installierte ezBlöcke';
$txt['ezp_txt_copyrightremoval'] = 'Urheberrecht Entfernung';
$txt['ezp_credits'] = 'Guthaben';

// Berechtigungen
$txt['permissiongroup_ezportal'] = 'EzPortal';
$txt['permissiongroup_simple_ezportal'] = 'EzPortal benutzen';

$txt['permissionname_ezportal_page'] = 'Seiten verwalten';
$txt['permissionhelp_ezportal_page'] = 'Ermöglicht das Hinzufügen, Bearbeiten und Löschen von Seiten.';
$txt['cannot_ezportal_page'] = 'Sie sind nicht berechtigt, EzPortal-Seiten zu verwalten.';

$txt['permissionname_ezportal_blocks'] = 'ezBlöcke verwalten';
$txt['permissionhelp_ezportal_blocks'] = 'Ermöglicht das Hinzufügen, Bearbeiten und Löschen von ezBlöcken.';
$txt['cannot_ezportal_blocks'] = 'Sie sind nicht berechtigt, ezBlöcke zu verwalten.';


$txt['permissionname_ezportal_manage'] = 'Admin EzPortal';
$txt['permissionhelp_ezportal_manage'] = 'Ermöglicht die volle Kontrolle über EzPortal';
$txt['cannot_ezportal_manage'] = 'Sie sind nicht berechtigt, EzPortal zu verwalten.';


$txt['whoall_forum'] = 'Betrachtet das Verzeichnis von <a href="' . $scripturl . '">' . $context['forum_name'] . '</a>.';

// END EzPortal Text Strings
]]></add>
	</operation>
</file>

<file name="$languagedir/Modifications.french.php" error="skip">
	<operation>
		<search position="end" />
		<add><![CDATA[
// Begin EzPortal Text Strings
$txt['ezp_forum_tab'] = 'Forum';
$txt['ezportal_admin'] = 'EzPortal';
$txt['ezportal_settings'] = 'Paramètres';
$txt['ezportal_block_manager'] = 'Gestionnaire ezBlock';
$txt['ezportal_page_manager'] = 'Gestionnaire de Page';

$txt['ezp_settings'] = 'Paramètres';
$txt['ezp_modules'] = 'Modules';
$txt['ezp_blocks'] = 'ezBlocks';
$txt['ezp_pagemanager'] = 'Gestionnaire de Page';
$txt['ezp_import'] = 'Importer';
$txt['ezp_txt_ordercopyright'] = 'Commander la suppression des droits d\'auteur';
$txt['ezp_download_blocks'] = 'Télécharger ezBlocks';
$txt['ezp_installed_blocks'] = 'ezBlocks installés';
$txt['ezp_txt_copyrightremoval'] = 'Suppression des droits d\'auteur';
$txt['ezp_credits'] = 'Crédits';

// Permissions
$txt['permissiongroup_ezportal'] = 'EzPortal';
$txt['permissiongroup_simple_ezportal'] = 'Utiliser EzPortal';

$txt['permissionname_ezportal_page'] = 'Gérer les Pages';
$txt['permissionhelp_ezportal_page'] = 'Permet l\'ajout, la modification et la suppression de pages.';
$txt['cannot_ezportal_page'] = 'Vous n\'êtes pas autorisé à gérer les pages EzPortal.';

$txt['permissionname_ezportal_blocks'] = 'Gérer ezBlocks';
$txt['permissionhelp_ezportal_blocks'] = 'Permet l\'ajout, la modification et la suppression de ezBlocks.';
$txt['cannot_ezportal_blocks'] = 'Vous n\'êtes pas autorisé à gérer les ezBlocks.';

$txt['permissionname_ezportal_manage'] = 'Admin EzPortal';
$txt['permissionhelp_ezportal_manage'] = 'Permet le contrôle total d\'EzPortal';
$txt['cannot_ezportal_manage'] = 'Vous n\'êtes pas autorisé à gérer EzPortal.';

$txt['whoall_forum'] = 'Consultation de l\'index de <a href="' . $scripturl . '">' . $context['forum_name'] . '</a>.';

// END EzPortal Text Strings
]]></add>
	</operation>
</file>


<file name="$languagedir/Modifications.dutch.php" error="skip">
	<operation>
		<search position="end" />
		<add><![CDATA[
// Begin EzPortal Text Strings
$txt['ezp_forum_tab'] = 'Forum';
$txt['ezportal_admin'] = 'EzPortal';
$txt['ezportal_settings'] = 'Instellingen';
$txt['ezportal_block_manager'] = 'ezBlock Manager';
$txt['ezportal_page_manager'] = 'Pagina Manager';

$txt['ezp_settings'] = 'Instellingen';
$txt['ezp_modules'] = 'Modules';
$txt['ezp_blocks'] = 'ezBlocks';
$txt['ezp_pagemanager'] = 'Pagina Manager';
$txt['ezp_import'] = 'Importeren';
$txt['ezp_txt_ordercopyright'] = 'Bestel Copyright Verwijdering';
$txt['ezp_download_blocks'] = 'Download ezBlocks';
$txt['ezp_installed_blocks'] = 'Geïnstalleerde ezBlocks';
$txt['ezp_txt_copyrightremoval'] = 'Copyright Verwijdering';
$txt['ezp_credits'] = 'Credits';

// Permissies
$txt['permissiongroup_ezportal'] = 'EzPortal';
$txt['permissiongroup_simple_ezportal'] = 'Gebruik EzPortal';

$txt['permissionname_ezportal_page'] = 'Beheer Pagina’s';
$txt['permissionhelp_ezportal_page'] = 'Staat het toevoegen, bewerken en verwijderen van pagina’s toe.';
$txt['cannot_ezportal_page'] = 'U heeft geen toestemming om de EzPortal pagina’s te beheren.';

$txt['permissionname_ezportal_blocks'] = 'Beheer ezBlocks';
$txt['permissionhelp_ezportal_blocks'] = 'Staat het toevoegen, bewerken en verwijderen van ezBlocks toe.';
$txt['cannot_ezportal_blocks'] = 'U heeft geen toestemming om ezBlocks te beheren.';

$txt['permissionname_ezportal_manage'] = 'Beheer EzPortal';
$txt['permissionhelp_ezportal_manage'] = 'Staat volledige controle over EzPortal toe.';
$txt['cannot_ezportal_manage'] = 'U heeft geen toestemming om EzPortal te beheren.';

$txt['wieall_forum'] = 'Bekijkt de index van <a href="' . $scripturl . '">' . $context['forum_naam'] . '</a>.';

// END EzPortal Text Strings
]]></add>
	</operation>
</file>

<file name="$languagedir/Who.english.php">
	<operation error="ignore">
		<search position="after"><![CDATA[?>]]></search>
		<add><![CDATA[
// Begin EzPortal
$txt['whoall_forum'] = 'Viewing the index of <a href="' . $scripturl . '">' . $context['forum_name'] . '</a>.';
// END EzPortal Strings			
]]></add>
	</operation>
</file>

<file name="$languagedir/Who.english-utf8.php" error="skip">
	<operation error="ignore">
		<search position="after"><![CDATA[?>]]></search>
		<add><![CDATA[
// Begin EzPortal
$txt['whoall_forum'] = 'Viewing the index of <a href="' . $scripturl . '">' . $context['forum_name'] . '</a>.';
// END EzPortal Strings			
]]></add>
	</operation>
</file>


<file name="$boarddir/index.php">
	<operation>
		<search position="before"><![CDATA[
		'editpoll2' => array('Poll.php', 'EditPoll2'),]]></search>
		<add><![CDATA[
		'ezportal' => array('EzPortal2.php', 'EzPortalMain'),
		 'forum' => array('BoardIndex.php', 'BoardIndex'),
		]]></add>
	</operation>
	<operation>
		<search position="replace"><![CDATA[// Attachments don't require the entire theme to be loaded.
	if (isset($_REQUEST['action']) && $_REQUEST['action'] == 'dlattach' && (!empty($modSettings['allow_guestAccess']) && $user_info['is_guest']))
		detectBrowser();
	// Load the current theme.  (note that ?theme=1 will also work, may be used for guest theming.)
	else
		loadTheme();]]></search>
		<add><![CDATA[// Attachments don't require the entire theme to be loaded.
	if (isset($_REQUEST['action']) && $_REQUEST['action'] == 'dlattach' && (!empty($modSettings['allow_guestAccess']) && $user_info['is_guest']))
		detectBrowser();
	// Load the current theme.  (note that ?theme=1 will also work, may be used for guest theming.)
	else
		loadTheme();
		
	// Setup EzPortal
	require_once($sourcedir . '/EzPortal2.php');
	SetupEzPortal();
	
	]]></add>
	</operation>	
<operation>
		<search position="replace"><![CDATA[// Action and board are both empty... BoardIndex!
		if (empty($board) && empty($topic))
		{
			require_once($sourcedir . '/BoardIndex.php');
			return 'BoardIndex';
		}
		// Topic is empty, and action is empty.... MessageIndex!]]></search>
		<add><![CDATA[
		// EzPortal
		global $ezpSettings;
		if ($ezpSettings['ezp_portal_enable'] == 1 && empty($board) && empty($topic))
		{


			    if (!empty($ezpSettings['ezp_disablemobiledevices']))
			    {

				    $user_agents = array(
						array('iPhone', 'iphone'),
						array('iPod', 'ipod'),
						array('PocketIE', 'iemobile'),
						array('Opera Mini', isset($_SERVER['HTTP_X_OPERAMINI_PHONE_UA']) ? $_SERVER['HTTP_X_OPERAMINI_PHONE_UA'] : "Opera Mini"),
						array('Opera Mobile', 'Opera Mobi'),
						array('Android', 'android'),
						array('Symbian', 'symbian'),
						array('BlackBerry', 'blackberry'),
						array('BlackBerry Storm', 'blackberry05'),
						array('Palm', 'palm'),
						array('Web OS', 'webos'),
					);

					foreach ($user_agents as $ua)
					{
						$string = (string) $ua[1];
						
						if (!empty($string))
						if ((strpos(strtolower($_SERVER['HTTP_USER_AGENT']), $string)))
						{
							require_once($sourcedir . '/BoardIndex.php');
							return 'BoardIndex';
						}

				}
			    }


					require_once($sourcedir . '/EzPortal2.php');
					return 'EzPortalForumHomePage';
		}
		
		// Action and board are both empty... BoardIndex!
		if (empty($board) && empty($topic))
		{
			require_once($sourcedir . '/BoardIndex.php');
			return 'BoardIndex';
		}
		// Topic is empty, and action is empty.... MessageIndex!
		

	
	]]></add>
	</operation>
	
	
</file>



<file name="$sourcedir/Admin.php">

	<operation>
		<search position="replace"><![CDATA['layout' => array(
			'title' => $txt['layout_controls'],]]></search>
		<add><![CDATA[
		'ezportal' => array(
			'title' => $txt['ezportal_admin'],
			'permission' => array('ezportal_page', 'ezportal_blocks', 'ezportal_manage'),
			'areas' => array(
				'ezpsettings' => array(
					'label' => $txt['ezportal_settings'],
					'file' => 'EzPortal2.php',
					'function' => 'EzPortalMain',
					'custom_url' => $scripturl . '?action=admin;area=ezpsettings;sa=settings;sesc=' . $sc,
					'icon' => 'server.gif',
					'permission' => array('ezportal_manage'),
					'subsections' => array(
						'settings' => array($txt['ezp_settings']),
						'modules' => array($txt['ezp_modules']),
						'import' => array($txt['ezp_import']),
						'copyright' => array($txt['ezp_txt_copyrightremoval']),
						'credits' => array($txt['ezp_credits']),
					),
				),
				'ezpblocks' => array(
					'label' => $txt['ezportal_block_manager'],
					'file' => 'EzPortal2.php',
					'function' => 'EzPortalMain',
					'custom_url' => $scripturl . '?action=admin;area=ezpblocks;sa=blocks;sesc=' . $sc,
					'icon' => 'server.gif',
					'permission' => array('ezportal_blocks', 'ezportal_manage'),
					'subsections' => array(
						'blocks' => array($txt['ezp_blocks']),
						'downloadblock' => array($txt['ezp_download_blocks']),
						'installedblocks' => array($txt['ezp_installed_blocks']),
					),
				),
				'ezppagemanager' => array(
					'label' => $txt['ezportal_page_manager'],
					'file' => 'EzPortal2.php',
					'function' => 'EzPortalMain',
					'custom_url' => $scripturl . '?action=admin;area=ezppagemanager;sa=pagemanager;sesc=' . $sc,
					'icon' => 'server.gif',
					'permission' => array('ezportal_page', 'ezportal_manage'),
					'subsections' => array(
						'pagemanager' => array($txt['ezp_pagemanager']),

					),
				),
			),
		),

		'layout' => array(
			'title' => $txt['layout_controls'],
				
]]></add>
	</operation>
</file>
<file name="$sourcedir/Subs.php">
	<operation>
		<search position="replace"><![CDATA[// Set up the menu privileges.]]></search>
		<add><![CDATA[
		
		// EzPortal
		global $ezpSettings;
		// Set up the menu privileges.
		
]]></add>
	</operation>
<operation>
		<search position="after"><![CDATA['help' => array(
				'title' => $txt['help'],
				'href' => $scripturl . '?action=help',
				'show' => true,
				'sub_buttons' => array(
				),
			),]]></search>
		<add><![CDATA[			
		// [Forum] button
			'forum' => array(
				'title' => $txt['ezp_forum_tab'],
				'href' => $scripturl . '?action=forum',
				'show' => !empty($ezpSettings['ezp_portal_enable']),
				'icon' => '',
			),
]]></add>
	</operation>
	
	
	<operation>
		<search position="replace"><![CDATA[$context['allow_admin'] = allowedTo(array(]]></search>
	<add><![CDATA[$context['allow_admin'] = allowedTo(array('ezportal_manage','ezportal_blocks','ezportal_page', ]]></add>
	</operation>
	
</file>

<file name="$sourcedir/ManagePermissions.php">
	<operation>
		<search position="before"><![CDATA[	$groupLevels['global']['standard'] = array_merge($groupLevels['global']['restrict'], array(]]></search>
		<add><![CDATA[
		'ezportal_page',
		'ezportal_blocks',
		'ezportal_manage',]]></add>
	</operation>

	<operation>
		<search position="before"><![CDATA[	$permissionList = array(
		'membergroup' => array(]]></search>
		<add><![CDATA[
			'ezportal_page' => array(false, 'ezportal', 'ezportal'),
			'ezportal_blocks' => array(false, 'ezportal', 'ezportal'),
			'ezportal_manage' => array(false, 'ezportal', 'ezportal'),]]></add>
	</operation>
</file>


<file name="$sourcedir/Load.php">
	<operation error="ignore"> 
		<search position="replace"><![CDATA[// Set the top level linktree up.
	array_unshift($context['linktree'], array(
		'url' => $scripturl,
		'name' => $context['forum_name']
	));]]></search>
		<add><![CDATA[// Removed old link tree Part EzPortal]]></add>
	</operation>
	
	<operation  error="ignore">
			<search position="replace"><![CDATA[// Set the top level linktree up.
	array_unshift($context['linktree'], array(
		'url' => $scripturl,
		'name' => $context['forum_name_html_safe']
	));]]></search>
			<add><![CDATA[// Removed old link tree Part EzPortal]]></add>
	</operation>	
	
	<operation>
		<search position="replace"><![CDATA[// Compatibility.
	if (!isset($settings['theme_version']))
		$modSettings['memberCount'] = $modSettings['totalMembers'];]]></search>
		<add><![CDATA[
// Compatibility.
	if (!isset($settings['theme_version']))
		$modSettings['memberCount'] = $modSettings['totalMembers'];
				
// Set the top level linktree up.
   array_unshift($context['linktree'], array(
      'url' => $scripturl,
      'name' => $context['forum_name']
   ), array('url' => $scripturl . '?action=forum', 'name' => $txt['ezp_forum_tab']));]]></add>
	</operation>
</file>

<file name="$sourcedir/Admin.php">
	<operation>
		<search position="before"><![CDATA[// You have to be able to do at least one of the below to see this page.
	isAllowedTo(array(]]></search>
		<add><![CDATA['ezportal_page', 'ezportal_blocks', 'ezportal_manage',]]></add>
	</operation>
</file>

<file name="$sourcedir/BoardIndex.php">
	<operation>
		<search position="replace"><![CDATA[// Retrieve the categories and boards.]]></search>
		<add><![CDATA[
		
		
		// EzPortal
		if (isset($_REQUEST['action']))
		{
				if ($_REQUEST['action'] == 'forum')
				{
					$context['robot_no_index'] = false;	
				}					
		}
		// End Ezportal
		
		// Retrieve the categories and boards.
		
]]></add>
	</operation>
</file>
</modification>